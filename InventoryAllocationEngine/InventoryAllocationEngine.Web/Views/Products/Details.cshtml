@model InventoryAllocationEngine.Web.Models.Product
@{
   ViewBag.Title = Model.Description;

   int overshort = Model.QuantityAvailable - Model.OrderItems.Sum(oi => oi.Quantity);
}

<h2 class="page-header">
   @Model.Description
</h2>

<p>
   Quantity Available: @Model.QuantityAvailable
</p>
<p>
   Pending Orders: @Model.OrderItems.Sum(oi => oi.Quantity)
</p>
<p>
   Over/(Short): <span class="@(overshort < 0 ? "text-danger" : "")"> @(overshort < 0 ? "(" + Math.Abs(overshort) + ")" : overshort.ToString())</span>
</p>

<div>

   @using (Html.BeginForm("Allocate", "Products", FormMethod.Post, new { @class = "form-inline" }))
   {
      <div class="form-group">
         <label for="allocationMethod">Allocation Method: </label>
         @Html.DropDownList("allocationMethod", new List<SelectListItem>
      {
         new SelectListItem
         {
            Text = "Simple"
         }
      }, new { @class = "form-control" })
         &nbsp;&nbsp;
      </div>

      <button type="submit" class="btn btn-primary">Allocate</button>
   }

</div>

<h3>Orders</h3>

<table class="table">
   <thead>
   <tr>
      <th>
         Order No.
      </th>
      <th>
         Date Received
      </th>
      <th>
         Customer
      </th>
      <th>
         Qty. Ordered
      </th>
   </tr>
   </thead>
   <tbody>
   @foreach (var orderItem in Model.OrderItems.OrderBy(oi => oi.Order.DateReceived))
   {
      <tr>
         <td>
            @orderItem.Order.Id
         </td>
         <td>
            @orderItem.Order.DateReceived.ToShortDateString()
         </td>
         <td>
            @orderItem.Order.Customer.Name
         </td>
         <td>
            @orderItem.Quantity
         </td>
      </tr>
   }
   </tbody>
</table>